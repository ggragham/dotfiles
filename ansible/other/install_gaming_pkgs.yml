---
- name: Install gaming packages
  hosts: localhost
  become: true
  vars_files: [../vars.yml]
  tasks:
    - name: Install flatpak
      include_tasks: '{{ ansible_path }}/_install_flatpak.yml'
    - name: Install flatpak pkgs
      block:
        - name: Bottles
          block:
            - name: Install Bottles
              flatpak:
                name: com.usebottles.bottles
                state: present
            - name: Configure permissions for Bottles
              shell:
                cmd: >
                  flatpak override --user \
                    --filesystem=xdg-data/applications \
                    com.usebottles.bottles
          when: ansible_distribution=="Fedora"
        - name: Lutris
          block:
            - name: Install Lutris
              flatpak:
                name: net.lutris.Lutris
                state: present
          when: ansible_distribution=="Debian"
      become_user: '{{ user }}'
